# üí≥ BankCards REST API

Backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏.  
–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–≤–æ–∏ –∫–∞—Ä—Ç—ã, –¥–µ–ª–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É –Ω–∏–º–∏,  
–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º ‚Äî —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–∞—Ä—Ç–∞–º–∏.  

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ **Spring Boot 3**, **Java 21**, **PostgreSQL**, **JWT Security**.

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Java 21+
- Docker & Docker Compose
- Maven 3.9+

---

### ‚ñ∂Ô∏è –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
git clone https://github.com/kossahokia/bankcards.git
cd bankcards
docker compose up --build
```
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:
| –°–µ—Ä–≤–∏—Å        | URL                                                                                        |
| ------------- | ------------------------------------------------------------------------------------------ |
| üß† API        | [http://localhost:8080](http://localhost:8080)                                             |
| üìò Swagger UI | [http://localhost:8080/swagger-ui/index.html](http://localhost:8080/swagger-ui/index.html) |
| üóÑÔ∏è PgAdmin   | [http://localhost:8081](http://localhost:8081)                                             |

–î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ PgAdmin:
Email: kostya4j@gmail.com
–ü–∞—Ä–æ–ª—å: postgres

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
üìÅ src
‚îú‚îÄüìÇ main
‚îÇ  ‚îú‚îÄüìÇ java/com/example/bankcards
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ config
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ controller
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ dto
‚îÇ  ‚îÇ  ‚îÇ   ‚îî‚îÄüìÅ enums
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ entity
‚îÇ  ‚îÇ  ‚îÇ   ‚îî‚îÄüìÅ enums
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ exception
‚îÇ  ‚îÇ  ‚îÇ   ‚îî‚îÄüìÅ customexceptions
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ repository
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ security
‚îÇ  ‚îÇ  ‚îú‚îÄüìÅ service
‚îÇ  ‚îÇ  ‚îî‚îÄüìÅ util
‚îÇ  ‚îî‚îÄüìÇ resources
‚îÇ      ‚îî‚îÄüìÇ db/migration
‚îî‚îÄüìÇ test
   ‚îú‚îÄüìÇ java/com/example/bankcards
   ‚îÇ  ‚îú‚îÄüìÅ controller
   ‚îÇ  ‚îî‚îÄüìÅ service
   ‚îî‚îÄüìÇ resources
      ‚îî‚îÄüß™ application-test.yml
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
JWT (JSON Web Token) ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –±–µ–∑ —Å–µ—Å—Å–∏–π
Spring Security 6 ‚Äî —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
BCrypt ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
CORS ‚Äî –≤–∫–ª—é—á—ë–Ω –≤ SecurityConfig

### –†–æ–ª–∏:
ADMIN ‚Äî –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–∞—Ä—Ç–∞–º–∏
USER ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –ø–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É —Å–≤–æ–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏–∑ –º–∏–≥—Ä–∞—Ü–∏–π Liquibase):
username: admin
password: admin123

## üí≥ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ API:
üß© AuthController (/api/auth):
| –ú–µ—Ç–æ–¥  | Endpoint    | –û–ø–∏—Å–∞–Ω–∏–µ                        |
| ------ | ----------- | ------------------------------- |
| `POST` | `/login`    | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –ø–æ–ª—É—á–µ–Ω–∏–µ JWT   |
| `POST` | `/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

üëë AdminController (/api/admin) (—Ç–æ–ª—å–∫–æ –¥–ª—è ADMIN):
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
| –ú–µ—Ç–æ–¥    | Endpoint                                | –û–ø–∏—Å–∞–Ω–∏–µ                                            |
| -------- | --------------------------------------- | --------------------------------------------------- |
| `POST`   | `/users`                                | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                               |
| `GET`    | `/users`                                | –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π) |
| `GET`    | `/users/{id}`                           | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID                         |
| `PATCH`  | `/users/{id}/status?enabled=true`       | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å / –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å                       |
| `PATCH`  | `/users/{id}/role?roleName=USER`        | –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å                                      |
| `PATCH`  | `/users/{id}/role/remove?roleName=USER` | –£–¥–∞–ª–∏—Ç—å —Ä–æ–ª—å                                        |
| `DELETE` | `/users/{id}`                           | –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                                |
| `GET`    | `/users/{id}/cards`                     | –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ä—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                         |

–ö–∞—Ä—Ç—ã:
| –ú–µ—Ç–æ–¥    | Endpoint                            | –û–ø–∏—Å–∞–Ω–∏–µ                                 |
| -------- | ----------------------------------- | ---------------------------------------- |
| `POST`   | `/cards`                            | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É                      |
| `GET`    | `/cards`                            | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–∞—Ä—Ç (—Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —Å—Ç–∞—Ç—É—Å—É) |
| `PATCH`  | `/cards/{id}/status?status=BLOCKED` | –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–∞—Ä—Ç—ã                    |
| `DELETE` | `/cards/{id}`                       | –£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç—É                            |

üíº CardController (/api/cards):
| –ú–µ—Ç–æ–¥  | Endpoint              | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| ------ | --------------------- | --------------------------------------- |
| `GET`  | `/`                   | –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –∫–∞—Ä—Ç (—Ñ–∏–ª—å—Ç—Ä, –ø–∞–≥–∏–Ω–∞—Ü–∏—è) |
| `GET`  | `/{id}/balance`       | –ë–∞–ª–∞–Ω—Å –∫–∞—Ä—Ç—ã                            |
| `POST` | `/{id}/request-block` | –ó–∞–ø—Ä–æ—Å –Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –∫–∞—Ä—Ç—ã              |
| `POST` | `/transfer`           | –ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É —Å–≤–æ–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏            |

## üßæ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:
User:
| –ü–æ–ª–µ     | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                 |
| -------- | --------- | ------------------------ |
| id       | Long      | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è          |
| username | String    | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –ª–æ–≥–∏–Ω         |
| password | String    | –•—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å      |
| fullName | String    | –ü–æ–ª–Ω–æ–µ –∏–º—è               |
| enabled  | boolean   | –ê–∫—Ç–∏–≤–µ–Ω / –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω   |
| roles    | Set<Role> | –°–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π             |
| cards    | Set<Card> | –°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

Card:
| –ü–æ–ª–µ     | –¢–∏–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                 |
| -------- | --------- | ------------------------ |
| id       | Long      | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è          |
| username | String    | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –ª–æ–≥–∏–Ω         |
| password | String    | –•—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å      |
| fullName | String    | –ü–æ–ª–Ω–æ–µ –∏–º—è               |
| enabled  | boolean   | –ê–∫—Ç–∏–≤–µ–Ω / –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω   |
| roles    | Set<Role> | –°–ø–∏—Å–æ–∫ —Ä–æ–ª–µ–π             |
| cards    | Set<Card> | –°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

Role:
| –ü–æ–ª–µ | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                        |
| ---- | ------ | ------------------------------- |
| id   | Long   | ID —Ä–æ–ª–∏                         |
| name | String | –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–ª–∏ (`USER`, `ADMIN`) |

## üîí –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ:
–í—Å–µ –Ω–æ–º–µ—Ä–∞ –∫–∞—Ä—Ç —à–∏—Ñ—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é AES-128 (EncryptionUtil)
–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–∞—Å–∫–∏:
**** **** **** 1234
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –∫–∞—Ä—Ç—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ CardExpiryUtil

## üß† –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
application.yml:
PostgreSQL (—á–µ—Ä–µ–∑ Docker)
Liquibase –º–∏–≥—Ä–∞—Ü–∏–∏
JWT –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (secret, expiration)
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π: WARN / INFO

application-test.yml:
Testcontainers (PostgreSQL 16)
–í –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ç–µ—Å—Ç–µ Liquibase –æ—Ç–∫–ª—é—á—ë–Ω –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ (—Å—Ö–µ–º–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏–∑ JPA)
–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã Hibernate

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
| –¢–∏–ø                  | –ö–æ–ª-–≤–æ                                      | –û–ø–∏—Å–∞–Ω–∏–µ                    |
| -------------------- | ------------------------------------------- | --------------------------- |
| **Unit-—Ç–µ—Å—Ç—ã**       | ~120                                        | –°–µ—Ä–≤–∏—Å—ã –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã       |
| **Integration-—Ç–µ—Å—Ç** | 1                                           | Smoke-—Ç–µ—Å—Ç —Å Testcontainers |
| **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏**       | JUnit 5, Mockito, AssertJ, Spring Boot Test |                             |

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
mvn clean test

## üê≥ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
docker-compose.yml –ø–æ–¥–Ω–∏–º–∞–µ—Ç:
| –°–µ—Ä–≤–∏—Å        | –í–µ—Ä—Å–∏—è | –ü–æ—Ä—Ç |
| ------------- | ------ | ---- |
| PostgreSQL    | 16     | 5432 |
| PgAdmin       | 8      | 8081 |
| BankCards App | ‚Äî      | 8080 |

## üìò –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:
Swagger UI: http://localhost:8080/swagger-ui/index.html
OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: src/main/resources/docs/openapi.yaml
–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏:
@Operation, @ApiResponses, @Schema
–û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ–¥—ã –æ—à–∏–±–æ–∫ (400, 401, 403, 404, 422, 500)

## üßæ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                       |
| --------- | -------------------------------- |
| Backend   | Java 21, Spring Boot 3.3         |
| Security  | Spring Security 6, JWT           |
| DB        | PostgreSQL 16, Liquibase         |
| Docs      | Swagger / OpenAPI 3              |
| Testing   | JUnit 5, Mockito, Testcontainers |
| DevOps    | Docker, Docker Compose           |
| Utils     | AES Encryption, Card masking     |

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä:
Konstantin Sahokiia
üìß kostya4j@gmail.com
üìß kos.sahokia@yandex.ru
üêô github.com/kossahokia
üí¨ Telegram: @kossahokia
